<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="聚合函数&amp;分组查询一、分组函数（聚集函数）分组函数的执行原则：先分组，然后对每一组数据执行分组函数。如果没有分组语句group by的话，整张表的数据自成一组。分组函数包括五个：  max：最大值 min：最小值 avg：平均值 sum：求和 count：计数   分组函数属于多行处理函数。多个输入，一个输出。  1.1 max找出员工的最高薪资 1select max(sal) from">
<meta property="og:type" content="article">
<meta property="og:title" content="第04章06节-查询DQL-聚合函数&amp;分组查询">
<meta property="og:url" content="http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="聚合函数&amp;分组查询一、分组函数（聚集函数）分组函数的执行原则：先分组，然后对每一组数据执行分组函数。如果没有分组语句group by的话，整张表的数据自成一组。分组函数包括五个：  max：最大值 min：最小值 avg：平均值 sum：求和 count：计数   分组函数属于多行处理函数。多个输入，一个输出。  1.1 max找出员工的最高薪资 1select max(sal) from">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072114506.png">
<meta property="og:image" content="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072127348.png">
<meta property="og:image" content="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072203441.png">
<meta property="og:image" content="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072203599.png">
<meta property="article:published_time" content="2024-06-07T14:02:21.000Z">
<meta property="article:modified_time" content="2024-07-23T13:50:06.249Z">
<meta property="article:author" content="Camellia.xiaohua">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072114506.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>第04章06节-查询DQL-聚合函数&amp;分组查询</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/projects/">项目</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2024/06/08/Blog/Java%20SE/26.%20Enum%EF%BC%88%E6%9E%9A%E4%B8%BE%EF%BC%89/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2024/06/07/Blog/Java%20SE/24.%20Java8%E7%9A%84%E6%96%B0%E6%97%A5%E6%9C%9FAPI/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&text=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&is_video=false&description=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=第04章06节-查询DQL-聚合函数&amp;分组查询&body=Check out this article: http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&name=第04章06节-查询DQL-聚合函数&amp;分组查询&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&t=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.</span> <span class="toc-text">聚合函数&amp;分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%EF%BC%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">一、分组函数（聚集函数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-max"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-min"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 min</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-avg"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 avg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-sum"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 sum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-count"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.6 分组函数组合使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.1.7.</span> <span class="toc-text">1.7 分组函数注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">二、分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-group-by"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 group by</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-having"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 having</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BB%84%E5%86%85%E6%8E%92%E5%BA%8F"><span class="toc-number">1.3.</span> <span class="toc-text">三、组内排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-GROUP-CONCAT"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 GROUP_CONCAT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">3.1.1 基本语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">3.1.2 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.1.2.1.</span> <span class="toc-text">结果</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3.1.3 可选参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">3.1.4 综合示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-1"><span class="toc-number">1.3.1.4.1.</span> <span class="toc-text">结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-SUBSTRING-INDEX"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 SUBSTRING_INDEX</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">3.2.1 基本语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">3.2.2 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-2"><span class="toc-number">1.3.2.2.1.</span> <span class="toc-text">结果</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-%E8%AF%A6%E7%BB%86%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3.2.3 详细示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">3.2.4 使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%BB%84%E5%86%85%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 组内查询案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93%E5%8D%95%E8%A1%A8%E7%9A%84DQL%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.</span> <span class="toc-text">四、总结单表的DQL语句</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        第04章06节-查询DQL-聚合函数&amp;分组查询
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Camellia.xiaohua</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-06-07T14:02:21.000Z" class="dt-published" itemprop="datePublished">2024-06-07</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/MySQL/">MySQL</a>
    </div>


      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h1 id="聚合函数-分组查询"><a href="#聚合函数-分组查询" class="headerlink" title="聚合函数&amp;分组查询"></a>聚合函数&amp;分组查询</h1><h2 id="一、分组函数（聚集函数）"><a href="#一、分组函数（聚集函数）" class="headerlink" title="一、分组函数（聚集函数）"></a>一、分组函数（聚集函数）</h2><p><strong>分组函数的执行原则：先分组，然后对每一组数据执行分组函数。如果没有分组语句group by的话，整张表的数据自成一组。</strong><br>分组函数包括五个：</p>
<ul>
<li>max：最大值</li>
<li>min：最小值</li>
<li>avg：平均值</li>
<li>sum：求和</li>
<li>count：计数</li>
</ul>
<blockquote>
<p>分组函数属于多行处理函数。多个输入，一个输出。</p>
</blockquote>
<h3 id="1-1-max"><a href="#1-1-max" class="headerlink" title="1.1 max"></a>1.1 max</h3><p><strong>找出员工的最高薪资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>


<h3 id="1-2-min"><a href="#1-2-min" class="headerlink" title="1.2 min"></a>1.2 min</h3><p><strong>找出员工的最低工资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>


<h3 id="1-3-avg"><a href="#1-3-avg" class="headerlink" title="1.3 avg"></a>1.3 avg</h3><p><strong>计算员工的平均薪资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>


<h3 id="1-4-sum"><a href="#1-4-sum" class="headerlink" title="1.4 sum"></a>1.4 sum</h3><p><strong>计算员工的工资和</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(sal) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p><strong>计算员工的津贴之和</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(comm) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<blockquote>
<p> [!TIP]<br> <strong>重点：所有的分组函数都是自动忽略NULL的。</strong> </p>
</blockquote>
<h3 id="1-5-count"><a href="#1-5-count" class="headerlink" title="1.5 count"></a>1.5 count</h3><p><strong>统计员工人数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(ename) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> emp;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p><strong>count(*)和count(1)的效果一样，统计该组中总记录行数。</strong><br><strong>count(ename)统计的是这个ename字段中不为NULL个数总和。</strong><br>例如：count(comm) 结果是 4，而不是14</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(comm) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<p><strong>统计岗位数量</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> job) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>[!TIP]<br>总结：</p>
<ol>
<li><p>COUNT(*) 用于计算表中行的总数，而 COUNT(某个字段) 用于计算某个特定字段中非 NULL 的值的数量。</p>
</li>
<li><p>count(*)和count(1)的效果一样，统计该组中总记录行数。</p>
</li>
</ol>
</blockquote>
<h3 id="1-6-分组函数组合使用"><a href="#1-6-分组函数组合使用" class="headerlink" title="1.6 分组函数组合使用"></a>1.6 分组函数组合使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> Count,<span class="built_in">sum</span>(sal) <span class="keyword">as</span> Sum,<span class="built_in">min</span>(sal) <span class="keyword">as</span> Min ,<span class="built_in">max</span>(sal) <span class="keyword">as</span> Max,<span class="built_in">avg</span>(sal) <span class="keyword">as</span> Avg <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072114506.png" style="zoom:80%;" />



<h3 id="1-7-分组函数注意事项"><a href="#1-7-分组函数注意事项" class="headerlink" title="1.7 分组函数注意事项"></a>1.7 分组函数注意事项</h3><p>&#x3D;&#x3D;<strong>分组函数不能直接使用在where子句当中</strong>&#x3D;&#x3D;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,job <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="built_in">avg</span>(sal);</span><br></pre></td></tr></table></figure>

<p> 这个会报错的<br>原因：分组的行为是在where执行之后才开始的。</p>
<h2 id="二、分组查询"><a href="#二、分组查询" class="headerlink" title="二、分组查询"></a>二、分组查询</h2><h3 id="2-1-group-by"><a href="#2-1-group-by" class="headerlink" title="2.1 group by"></a>2.1 group by</h3><p>按照某个字段分组，或者按照某些字段联合分组。</p>
<p><strong>注意：group by的执行是在where之后执行。</strong><br>语法：<br><code>group by 字段</code><br><code>group by 字段1,字段2,字段3....</code></p>
<p><strong>找出每个岗位的平均薪资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> job, <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> job;</span><br></pre></td></tr></table></figure>
<p><strong>找出每个部门最高工资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>
<p><strong>找出每个部门不同岗位的平均薪资</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,job,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno,job;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>当select语句中有group by的话，select后面只能跟<mark>分组函数</mark>或<mark>参加分组的字段</mark></strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno; <span class="operator">/</span><span class="operator">/</span> 这个<span class="keyword">SQL</span>执行后会报错。</span><br></pre></td></tr></table></figure>
<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072127348.png" alt="image.png" style="zoom:67%;" />



<h3 id="2-2-having"><a href="#2-2-having" class="headerlink" title="2.2 having"></a>2.2 having</h3><p>having写在group by的后面，而且不能单独使用。当你对分组之后的数据不满意，可以继续通过having对分组之后的数据进行过滤。<br>where的过滤是在分组前进行过滤。<br><strong>使用原则：尽量在where中过滤，实在不行，再使用having。越早过滤效率越高。</strong></p>
<blockquote>
<p>[!CAUTION]</p>
<p><strong>WHERE子句中是不能使用聚集函数作为表达式的，<mark>聚集函数只能用于SELECT子句和GROUP BY中的HAVING子句</mark></strong></p>
</blockquote>
<p><strong>找出除20部分之外，其它部门的平均薪资。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">&lt;&gt;</span><span class="number">20</span> <span class="keyword">group</span> <span class="keyword">by</span> deptno; <span class="operator">/</span><span class="operator">/</span> 建议</span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> deptno <span class="operator">&lt;&gt;</span> <span class="number">20</span>; <span class="operator">/</span><span class="operator">/</span> 不建议</span><br></pre></td></tr></table></figure>

<p><strong>查询每个部门平均薪资，找出平均薪资高于2000的。</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> <span class="built_in">avg</span>(sal) <span class="operator">&gt;</span> <span class="number">2000</span>;</span><br></pre></td></tr></table></figure>
<h2 id="三、组内排序"><a href="#三、组内排序" class="headerlink" title="三、组内排序"></a>三、组内排序</h2><h3 id="3-1-GROUP-CONCAT"><a href="#3-1-GROUP-CONCAT" class="headerlink" title="3.1 GROUP_CONCAT"></a>3.1 GROUP_CONCAT</h3><p><code>GROUP_CONCAT</code> 是 MySQL 中的一个聚合函数，用于将分组中的多个值连接成一个字符串。它在进行数据汇总时特别有用，比如将某一列的多个值连接成一个以逗号分隔的字符串。</p>
<h4 id="3-1-1-基本语法"><a href="#3-1-1-基本语法" class="headerlink" title="3.1.1 基本语法"></a>3.1.1 基本语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> GROUP_CONCAT(column_name)</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line">[<span class="keyword">WHERE</span> <span class="keyword">condition</span>]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> column_name2];</span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-示例"><a href="#3-1-2-示例" class="headerlink" title="3.1.2 示例"></a>3.1.2 示例</h4><p>假设有一个名为 <code>students</code> 的表，结构和数据如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>course</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Alice</td>
<td>Math</td>
</tr>
<tr>
<td>2</td>
<td>Bob</td>
<td>Science</td>
</tr>
<tr>
<td>3</td>
<td>Alice</td>
<td>History</td>
</tr>
<tr>
<td>4</td>
<td>Bob</td>
<td>Math</td>
</tr>
<tr>
<td>5</td>
<td>Alice</td>
<td>Science</td>
</tr>
</tbody></table>
<p>我们想要得到每个学生所选课程的一个列表。可以使用 <code>GROUP_CONCAT</code> 来实现：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, GROUP_CONCAT(course) <span class="keyword">AS</span> courses</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>

<h5 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h5><table>
<thead>
<tr>
<th>name</th>
<th>courses</th>
</tr>
</thead>
<tbody><tr>
<td>Alice</td>
<td>Math,History,Science</td>
</tr>
<tr>
<td>Bob</td>
<td>Science,Math</td>
</tr>
</tbody></table>
<h4 id="3-1-3-可选参数"><a href="#3-1-3-可选参数" class="headerlink" title="3.1.3 可选参数"></a>3.1.3 可选参数</h4><p><code>GROUP_CONCAT</code> 函数还有一些可选参数可以用来改变其行为：</p>
<ol>
<li><p>**<code>SEPARATOR</code>**：指定分隔符，默认为逗号 <code>,</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, GROUP_CONCAT(course SEPARATOR <span class="string">&#x27; | &#x27;</span>) <span class="keyword">AS</span> courses</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>**<code>DISTINCT</code>**：去重，防止重复值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, GROUP_CONCAT(<span class="keyword">DISTINCT</span> course) <span class="keyword">AS</span> courses</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>**<code>ORDER BY</code>**：指定连接值的排序方式。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, GROUP_CONCAT(course <span class="keyword">ORDER</span> <span class="keyword">BY</span> course <span class="keyword">ASC</span>) <span class="keyword">AS</span> courses</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>
</li>
<li><p>**<code>LIMIT</code>**：限制结果的长度（不常用）。</p>
</li>
</ol>
<h4 id="3-1-4-综合示例"><a href="#3-1-4-综合示例" class="headerlink" title="3.1.4 综合示例"></a>3.1.4 综合示例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, GROUP_CONCAT(<span class="keyword">DISTINCT</span> course <span class="keyword">ORDER</span> <span class="keyword">BY</span> course <span class="keyword">ASC</span> SEPARATOR <span class="string">&#x27; | &#x27;</span>) <span class="keyword">AS</span> courses</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br></pre></td></tr></table></figure>

<h5 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h5><table>
<thead>
<tr>
<th>name</th>
<th>courses</th>
</tr>
</thead>
<tbody><tr>
<td>Alice</td>
<td>History</td>
</tr>
<tr>
<td>Bob</td>
<td>Math</td>
</tr>
</tbody></table>
<p>通过以上方式，<code>GROUP_CONCAT</code> 可以灵活地将多行数据合并成一个字符串，满足各种需求。</p>
<h3 id="3-2-SUBSTRING-INDEX"><a href="#3-2-SUBSTRING-INDEX" class="headerlink" title="3.2 SUBSTRING_INDEX"></a>3.2 SUBSTRING_INDEX</h3><p><code>SUBSTRING_INDEX</code> 是 MySQL 中用于截取字符串的函数，可以根据指定的分隔符将字符串拆分并返回特定部分。该函数非常适用于需要从字符串中提取特定子字符串的场景。</p>
<h4 id="3-2-1-基本语法"><a href="#3-2-1-基本语法" class="headerlink" title="3.2.1 基本语法"></a>3.2.1 基本语法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUBSTRING_INDEX(str, delim, count)</span><br></pre></td></tr></table></figure>

<ul>
<li>**<code>str</code>**：要处理的字符串。</li>
<li>**<code>delim</code>**：字符串中的分隔符。</li>
<li>**<code>count</code>**：指定要返回的部分。正数表示从左到右，负数表示从右到左。</li>
</ul>
<h4 id="3-2-2-示例"><a href="#3-2-2-示例" class="headerlink" title="3.2.2 示例"></a>3.2.2 示例</h4><p>假设我们有一个表 <code>users</code>，其中有一列 <code>email</code> 存储用户的电子邮件地址：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>email</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><a href="mailto:&#106;&#111;&#x68;&#110;&#x2e;&#x64;&#x6f;&#x65;&#x40;&#101;&#120;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#111;&#109;">&#106;&#111;&#x68;&#110;&#x2e;&#x64;&#x6f;&#x65;&#x40;&#101;&#120;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>2</td>
<td><a href="mailto:&#x6a;&#97;&#110;&#101;&#x2e;&#x73;&#x6d;&#x69;&#116;&#x68;&#64;&#116;&#101;&#115;&#116;&#x2e;&#x63;&#111;&#109;">&#x6a;&#97;&#110;&#101;&#x2e;&#x73;&#x6d;&#x69;&#116;&#x68;&#64;&#116;&#101;&#115;&#116;&#x2e;&#x63;&#111;&#109;</a></td>
</tr>
<tr>
<td>3</td>
<td><a href="mailto:&#x61;&#108;&#105;&#x63;&#x65;&#x40;&#100;&#x6f;&#109;&#x61;&#x69;&#110;&#x2e;&#x6f;&#x72;&#103;">&#x61;&#108;&#105;&#x63;&#x65;&#x40;&#100;&#x6f;&#109;&#x61;&#x69;&#110;&#x2e;&#x6f;&#x72;&#103;</a></td>
</tr>
</tbody></table>
<p>我们想要从电子邮件地址中提取用户名（即 <code>@</code> 符号前的部分）。可以使用 <code>SUBSTRING_INDEX</code> 实现：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> email, SUBSTRING_INDEX(email, <span class="string">&#x27;@&#x27;</span>, <span class="number">1</span>) <span class="keyword">AS</span> username</span><br><span class="line"><span class="keyword">FROM</span> users;</span><br></pre></td></tr></table></figure>

<h5 id="结果-2"><a href="#结果-2" class="headerlink" title="结果"></a>结果</h5><table>
<thead>
<tr>
<th>email</th>
<th>username</th>
</tr>
</thead>
<tbody><tr>
<td><a href="mailto:&#x6a;&#x6f;&#x68;&#110;&#x2e;&#x64;&#x6f;&#101;&#x40;&#101;&#x78;&#x61;&#x6d;&#x70;&#x6c;&#x65;&#x2e;&#99;&#x6f;&#109;">&#x6a;&#x6f;&#x68;&#110;&#x2e;&#x64;&#x6f;&#101;&#x40;&#101;&#x78;&#x61;&#x6d;&#x70;&#x6c;&#x65;&#x2e;&#99;&#x6f;&#109;</a></td>
<td>john.doe</td>
</tr>
<tr>
<td><a href="mailto:&#x6a;&#x61;&#110;&#x65;&#x2e;&#x73;&#109;&#x69;&#x74;&#x68;&#x40;&#x74;&#101;&#115;&#x74;&#x2e;&#99;&#x6f;&#x6d;">&#x6a;&#x61;&#110;&#x65;&#x2e;&#x73;&#109;&#x69;&#x74;&#x68;&#x40;&#x74;&#101;&#115;&#x74;&#x2e;&#99;&#x6f;&#x6d;</a></td>
<td>jane.smith</td>
</tr>
<tr>
<td><a href="mailto:&#x61;&#108;&#x69;&#99;&#101;&#64;&#100;&#x6f;&#x6d;&#97;&#105;&#110;&#46;&#111;&#x72;&#x67;">&#x61;&#108;&#x69;&#99;&#101;&#64;&#100;&#x6f;&#x6d;&#97;&#105;&#110;&#46;&#111;&#x72;&#x67;</a></td>
<td>alice</td>
</tr>
</tbody></table>
<h4 id="3-2-3-详细示例"><a href="#3-2-3-详细示例" class="headerlink" title="3.2.3 详细示例"></a>3.2.3 详细示例</h4><ol>
<li><p><strong>从字符串中提取域名（<code>@</code> 符号后的部分）</strong>：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> email, SUBSTRING_INDEX(email, <span class="string">&#x27;@&#x27;</span>, <span class="number">-1</span>) <span class="keyword">AS</span> domain</span><br><span class="line"><span class="keyword">FROM</span> users;</span><br></pre></td></tr></table></figure>

<p> 结果：</p>
<table>
<thead>
<tr>
<th>email</th>
<th>domain</th>
</tr>
</thead>
<tbody><tr>
<td><a href="mailto:&#x6a;&#x6f;&#x68;&#110;&#x2e;&#x64;&#111;&#x65;&#x40;&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#101;&#x2e;&#99;&#111;&#x6d;">&#x6a;&#x6f;&#x68;&#110;&#x2e;&#x64;&#111;&#x65;&#x40;&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#101;&#x2e;&#99;&#111;&#x6d;</a></td>
<td>example.com</td>
</tr>
<tr>
<td><a href="mailto:&#x6a;&#97;&#x6e;&#101;&#x2e;&#115;&#109;&#x69;&#x74;&#104;&#64;&#116;&#101;&#115;&#x74;&#x2e;&#x63;&#x6f;&#x6d;">&#x6a;&#97;&#x6e;&#101;&#x2e;&#115;&#109;&#x69;&#x74;&#104;&#64;&#116;&#101;&#115;&#x74;&#x2e;&#x63;&#x6f;&#x6d;</a></td>
<td>test.com</td>
</tr>
<tr>
<td><a href="mailto:&#97;&#x6c;&#x69;&#99;&#x65;&#64;&#x64;&#x6f;&#x6d;&#97;&#x69;&#110;&#46;&#111;&#114;&#103;">&#97;&#x6c;&#x69;&#99;&#x65;&#64;&#x64;&#x6f;&#x6d;&#97;&#x69;&#110;&#46;&#111;&#114;&#103;</a></td>
<td>domain.org</td>
</tr>
</tbody></table>
</li>
<li><p><strong>从URL中提取协议（假设表中有一列 <code>url</code>）</strong>：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> url, SUBSTRING_INDEX(url, <span class="string">&#x27;://&#x27;</span>, <span class="number">1</span>) <span class="keyword">AS</span> protocol</span><br><span class="line"><span class="keyword">FROM</span> websites;</span><br></pre></td></tr></table></figure>

<p> 如果 <code>websites</code> 表如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>url</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td><a target="_blank" rel="noopener" href="https://www.example.com/">https://www.example.com</a></td>
</tr>
<tr>
<td>2</td>
<td><a target="_blank" rel="noopener" href="http://test.com/">http://test.com</a></td>
</tr>
<tr>
<td>3</td>
<td><a href="ftp://files.domain.org/">ftp://files.domain.org</a></td>
</tr>
</tbody></table>
<p> 结果：</p>
<table>
<thead>
<tr>
<th>url</th>
<th>protocol</th>
</tr>
</thead>
<tbody><tr>
<td><a target="_blank" rel="noopener" href="https://www.example.com/">https://www.example.com</a></td>
<td>https</td>
</tr>
<tr>
<td><a target="_blank" rel="noopener" href="http://test.com/">http://test.com</a></td>
<td>http</td>
</tr>
<tr>
<td><a href="ftp://files.domain.org/">ftp://files.domain.org</a></td>
<td>ftp</td>
</tr>
</tbody></table>
</li>
<li><p><strong>提取某个字符串中的第一个单词</strong>：</p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sentence, SUBSTRING_INDEX(sentence, <span class="string">&#x27; &#x27;</span>, <span class="number">1</span>) <span class="keyword">AS</span> first_word</span><br><span class="line"><span class="keyword">FROM</span> phrases;</span><br></pre></td></tr></table></figure>

<p> 如果 <code>phrases</code> 表如下：</p>
<table>
<thead>
<tr>
<th>id</th>
<th>sentence</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Hello world!</td>
</tr>
<tr>
<td>2</td>
<td>OpenAI develops AI models</td>
</tr>
<tr>
<td>3</td>
<td>SQL is fun</td>
</tr>
</tbody></table>
<p> 结果：</p>
<table>
<thead>
<tr>
<th>sentence</th>
<th>first_word</th>
</tr>
</thead>
<tbody><tr>
<td>Hello world!</td>
<td>Hello</td>
</tr>
<tr>
<td>OpenAI develops AI models</td>
<td>OpenAI</td>
</tr>
<tr>
<td>SQL is fun</td>
<td>SQL</td>
</tr>
</tbody></table>
</li>
</ol>
<h4 id="3-2-4-使用注意事项"><a href="#3-2-4-使用注意事项" class="headerlink" title="3.2.4 使用注意事项"></a>3.2.4 使用注意事项</h4><ul>
<li><strong>如果 <code>count</code> 为正数，则从字符串左边开始计数。</strong></li>
<li><strong>如果 <code>count</code> 为负数，则从字符串右边开始计数。</strong></li>
<li><strong>如果 <code>count</code> 超出分隔符的数量，则返回整个字符串。</strong></li>
</ul>
<p><code>SUBSTRING_INDEX</code> 是处理字符串的强大工具，通过合理设置分隔符和计数，可以方便地提取出所需的子字符串。</p>
<h3 id="3-3-组内查询案例"><a href="#3-3-组内查询案例" class="headerlink" title="3.3 组内查询案例"></a>3.3 组内查询案例</h3><p>案例：找出每个工作岗位的工资排名在前两名的。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 找出每个工作岗位的工资排名在前两名的。</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTRING_INDEX(GROUP_CONCAT(SAL <span class="keyword">ORDER</span> <span class="keyword">BY</span> SAL <span class="keyword">ASC</span> ),<span class="string">&#x27;,&#x27;</span>,<span class="number">2</span>)  <span class="keyword">FROM</span> EMP <span class="keyword">GROUP</span> <span class="keyword">BY</span> JOB;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>substring_index函数的使用：</p>
<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072203441.png" alt="image.png" style="zoom:67%;" />

<p>group_concat函数的使用：</p>
<img src="https://camelliaxiaohua-1313958787.cos.ap-shanghai.myqcloud.com/asserts_JavaSE/202406072203599.png" alt="image.png" style="zoom:67%;" />

<p>学习了这两个函数之后，自己可以尝试写出来吗？</p>
<h2 id="四、总结单表的DQL语句"><a href="#四、总结单表的DQL语句" class="headerlink" title="四、总结单表的DQL语句"></a>四、总结单表的DQL语句</h2><p>select …5<br>from …1<br>where …2<br>group by …3<br>having …4<br>order by …6<br>重点掌握一个完整的DQL语句执行顺序。</p>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/categories/">分类</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a href="/tags/">标签</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
          <li><a href="/projects/">项目</a></li>
        
          <li><a href="/links/">links</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.</span> <span class="toc-text">聚合函数&amp;分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%EF%BC%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">一、分组函数（聚集函数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-max"><span class="toc-number">1.1.1.</span> <span class="toc-text">1.1 max</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-min"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.2 min</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-avg"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.3 avg</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-sum"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.4 sum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-count"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.5 count</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.6.</span> <span class="toc-text">1.6 分组函数组合使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.1.7.</span> <span class="toc-text">1.7 分组函数注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">二、分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-group-by"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 group by</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-having"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2 having</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BB%84%E5%86%85%E6%8E%92%E5%BA%8F"><span class="toc-number">1.3.</span> <span class="toc-text">三、组内排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-GROUP-CONCAT"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 GROUP_CONCAT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">3.1.1 基本语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">3.1.2 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-number">1.3.1.2.1.</span> <span class="toc-text">结果</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">3.1.3 可选参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-4-%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.1.4.</span> <span class="toc-text">3.1.4 综合示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-1"><span class="toc-number">1.3.1.4.1.</span> <span class="toc-text">结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-SUBSTRING-INDEX"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 SUBSTRING_INDEX</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.3.2.1.</span> <span class="toc-text">3.2.1 基本语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.2.2.</span> <span class="toc-text">3.2.2 示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-2"><span class="toc-number">1.3.2.2.1.</span> <span class="toc-text">结果</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-%E8%AF%A6%E7%BB%86%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.3.2.3.</span> <span class="toc-text">3.2.3 详细示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.3.2.4.</span> <span class="toc-text">3.2.4 使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%BB%84%E5%86%85%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 组内查询案例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%80%BB%E7%BB%93%E5%8D%95%E8%A1%A8%E7%9A%84DQL%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.</span> <span class="toc-text">四、总结单表的DQL语句</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&text=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&is_video=false&description=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=第04章06节-查询DQL-聚合函数&amp;分组查询&body=Check out this article: http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&title=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&name=第04章06节-查询DQL-聚合函数&amp;分组查询&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/06/07/Blog/MySQL/13.%20%E7%AC%AC04%E7%AB%A006%E8%8A%82-%E6%9F%A5%E8%AF%A2DQL-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0&amp;%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2/&t=第04章06节-查询DQL-聚合函数&amp;分组查询"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2024
    Camellia.xiaohua
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/projects/">项目</a></li><!--
     --><!--
       --><li><a href="/links/">links</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'Camellia.xiaohua';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
